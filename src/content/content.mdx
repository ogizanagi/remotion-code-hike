---
title: Apollo local resolvers

# video
fps: 30
width: 2096
height: 1180

# steps
stepDuration: 90
evenSteps: false
transitionDuration: 30
---

import "./../style.css";

## !!steps Intro

!duration 80

![!cover Intro](../../public/images/apollo-local-resolvers/intro.png)

---

## !!steps Query

!duration 100
!callout [2,12,13,"Imaginons que cette query ne soit pas encore \nexpos√©e par notre serveur GraphQL"]

```graphql ! query1
query GetWidgets {
  getWidgets {
    count
    rows {
      id
      name
    }
  }
}
```

## !!steps Query

!duration 80
!callout [2,12,13,"On l'annote avec la directive @client pour utiliser un resolver local"]

```graphql ! query1
query GetWidgets {
  getWidgets {
    count
    rows {
      id
      name
    }
  }
}
```

## !!steps Query

!duration 60

```graphql ! query1
query GetWidgets {
  getWidgets @client {
    count
    rows {
      id
      name
    }
  }
}
```

---

## !!steps Fake data

```typescript ! fake-data
// !duration 90
// !callout[/FakeWidgets/]  üßë‚Äçüé®  On pr√©pare des donn√©es fictives
const FakeWidgets = [
  { id: 1, name: 'Widget 1' },
  { id: 2, name: 'Widget 2' },
  { id: 3, name: 'Widget 3' },
  { id: 4, name: 'Widget 4' },
  { id: 5, name: 'Widget 5' },
  // [‚Ä¶]
];
```

## !!steps Resolver

```typescript ! resolver
// !duration 90
// !callout[/client/] Puis, au niveau du client Apollo‚Ä¶
const client = new ApolloClient({
  cache: new InMemoryCache(),
});
```

## !!steps Resolver

```typescript ! resolver
// !duration 90
const client = new ApolloClient({
  cache: new InMemoryCache(),
  // !callout[/resolvers/] on renseigne un resolver local pour notre query üëáüèª
  resolvers: {
    Query: {
      // !mark(1:3)
      getWidgets: () => {
        // ...
      }
    }
  }
});
```

## !!steps Resolver

```typescript ! resolver
// !duration 90
const client = new ApolloClient({
  cache: new InMemoryCache(),
  resolvers: {
    Query: {
      // !mark(1:5)
      getWidgets: () => ({
        // !callout[/__typename/] Dans lequel on fournit la structure attendue en retour
        __typename: 'WidgetList',
        count: FakeWidgets.length,
        rows: FakeWidgets,
      })
    }
  }
});
```

## !!steps Resolver

```typescript ! resolver
// !duration 80
// !mark(5:9)
const client = new ApolloClient({
  cache: new InMemoryCache(),
  resolvers: {
    Query: {
      getWidgets: () => ({
        __typename: 'WidgetList',
        count: FakeWidgets.length,
        // !callout[/FakeWidgets/] Avec nos lignes de donn√©es simul√©es
        rows: FakeWidgets,
      })
    }
  }
});
```

---

## !!steps Component

```typescript ! component
// !duration 120
import { useQuery } from '@apollo/client';
import GET_WIDGETS from './queries/GetWidgets.graphql';

// !callout[/useQuery\(GET_WIDGETS\)/] On consomme notre query de mani√®re habituelle
const { data } = useQuery(GET_WIDGETS);
```

## !!steps Component

```typescript ! component
// !duration 120
import { useQuery } from '@apollo/client';
import GET_WIDGETS from './queries/GetWidgets.graphql';

// !callout[/useQuery\(GET_WIDGETS\)/] { "message": "Sauf qu'au lieu de contacter le serveur GraphQL, \nnotre resolver c√¥t√© client est utilis√©" }
const { data } = useQuery(GET_WIDGETS);
```

## !!steps Component

```typescript ! component
// !duration 30
import { useQuery } from '@apollo/client';
import GET_WIDGETS from './queries/GetWidgets.graphql';

// !callout[/data/] { "start" : 5, "end": 20, "message": "et nous obtenons nos donn√©es fictives ! ‚ú®"}
const { data } = useQuery(GET_WIDGETS);
```

## !!steps Component

```typescript ! component
// !duration 90
import { useQuery } from '@apollo/client';
import GET_WIDGETS from './queries/GetWidgets.graphql';

// !callout[/data/] { "start" : 0, "end": 0, "message": "et nous obtenons nos donn√©es fictives ! ‚ú®"}
const { data } = useQuery(GET_WIDGETS);

// !mark(1:10)
 data: {
   getWidgets: {
     count: 5,
     rows: [
       { id: 1, name: 'Widget 1' },
       { id: 2, name: 'Widget 2' },
       [‚Ä¶]
     ]
   }
 }
```

---

## !!steps Query2

!duration 70
!callout [2,3,12,"Il est possible de simuler l'enti√®ret√© d'une query"]

```graphql ! query2
query GetWidgets {
  getWidgets @client {
    count
    rows {
      id
      name
      dataset
    }
  }
}
```

## !!steps Query2

!duration 70
!callout [7,7,13,"ou seulement une partie"]

```graphql ! query2
query GetWidgets {
  getWidgets {
    count
    rows {
      id
      name
      dataset @client
    }
  }
}
```

## !!steps Query2

!duration 90
!callout [2,3,11,"ainsi que des mutations !"]

```graphql ! query2
mutation AddWidgets {
  addWidget @client {
    id
    name
  }
}
```

---

## !!steps Conclusion

!duration 70

```markdown ! conclusion
## En r√©sum√© üëÄ

- Nous avons simul√© une query GraphQL c√¥t√© client
  **sans toucher √† notre code fonctionnel** ‚ú®
```

## !!steps Conclusion

!duration 70

```markdown ! conclusion
## En r√©sum√© üëÄ

- Nous avons simul√© une query GraphQL c√¥t√© client
  **sans toucher √† notre code fonctionnel** ‚ú®

- Lorsque la query sera disponible c√¥t√© serveur,
  il suffira de retirer la directive `@client`
```

## !!steps Conclusion

!duration 70

```markdown ! conclusion
## En r√©sum√© üëÄ

- Nous avons simul√© une query GraphQL c√¥t√© client
  **sans toucher √† notre code fonctionnel** ‚ú®

- Lorsque la query sera disponible c√¥t√© serveur,
  il suffira de retirer la directive `@client`

- L'ensemble des interactions avec notre UI et les donn√©es
  peuvent √™tre anticip√©es par l'√©quipe front
```

## !!steps Conclusion

!duration 50

```markdown ! conclusion
## En r√©sum√© üëÄ

- Nous avons simul√© une query GraphQL c√¥t√© client
  **sans toucher √† notre code fonctionnel** ‚ú®

- Lorsque la query sera disponible c√¥t√© serveur,
  il suffira de retirer la directive `@client`

- L'ensemble des interactions avec notre UI et les donn√©es
  peuvent √™tre anticip√©es par l'√©quipe front

- ind√©pendamment du back-end ! ü§å
```

---

## !!steps Outro

!duration 191

![!cover Outro](../../public/images/apollo-local-resolvers/outro.png)
